<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Run My Python (Pyodide)</title>
    <script type="module">
      import { loadPyodide } from "https://cdn.jsdelivr.net/pyodide/v0.26.2/full/pyodide.mjs";
      let pyodideReady = loadPyodide();
      const ansChoices = shuffle([
            "1. The coming of the French and English",
            "2. The Critical Period: from Confederation to Constitution", 
            "3. The Revolutionary Era",
            "4. The coming of the Spanish",
            "5. The colonial period"
          ]);
      function shuffle(array) {
        const a = array.slice();
        for (let i = a.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [a[i], a[j]] = [a[j], a[i]];
        }
        return a;
      }
      function renderChoices(shuffled) {
        
        

        const container = document.getElementById("choices");
        container.innerHTML = ""; // clear
        shuffled.forEach(choice => {
          const p = document.createElement("p");
          p.textContent = choice;
          container.appendChild(p);
        });
      }
      async function runScript() {
        const out = document.getElementById("out");
        out.textContent = "Running…";
        try {
          const pyodide = await pyodideReady;

          // If you need pure-Python packages from PyPI (no native code), you can micropip-install like this:
          // await pyodide.loadPackage("micropip");
          // await pyodide.runPythonAsync(`
          //   import micropip
          //   await micropip.install("some-pure-python-package")
          // `);

          // Collect inputs (edit these IDs to match your UI)
          const A1 = document.getElementById("A1").value.trim();
          const B1 = document.getElementById("B1").value.trim();
          const C1 = document.getElementById("C1").value.trim();
          const D1 = document.getElementById("D1").value.trim();
          const E1 = document.getElementById("E1").value.trim();

          // ---------- Your prewritten Python goes here ----------
          const code = `
def checkAns(a1: str, b1: str, c1: str, d1: str, e1: str, ans) -> str:
    if(not (a1 and b1 and c1 and d1 and e1)):
        return "Please fill in all fields."
    score = 0
    if(ans[int(a1)] == "The coming of the Spanish"):
        score = 5
    return str(score) + "/5"

checkAns("${A1.replace(/\\/g, "\\\\").replace(/`/g, "\\`")}", "${B1.replace(/\\/g, "\\\\").replace(/`/g, "\\`")}", "${C1.replace(/\\/g, "\\\\").replace(/`/g, "\\`")}", "${D1.replace(/\\/g, "\\\\").replace(/`/g, "\\`")}", "${E1.replace(/\\/g, "\\\\").replace(/`/g, "\\`")}", ${ansChoices})
`;
          const result = await pyodide.runPythonAsync(code);
          out.textContent = String(result);
        } catch (e) {
          out.textContent = "Error: " + e;
        }
      }

      window.runScript = runScript;
      document.addEventListener("DOMContentLoaded", () => {
        renderChoices(ansChoices);
      });
    </script>
    <style>
      :root { color-scheme: light dark; }
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, sans-serif;
             max-width: 720px; margin: 2rem auto; padding: 0 1rem; }
      h1 { font-size: clamp(1.6rem, 2.5vw + 1rem, 2.2rem); margin-bottom: .25rem; }
      p.lead { opacity: .8; margin-top: 0; }
      .card { background: rgba(0,0,0,.03); padding: 1rem; border-radius: 12px; }
      input, button, textarea { font: inherit; padding: .6rem .8rem; border-radius: 10px;
                                border: 1px solid rgba(0,0,0,.15); }
      button { cursor: pointer; }
      #out { white-space: pre-wrap; min-height: 2.5rem; }
      footer { margin-top: 2rem; opacity: .7; font-size: .9rem; }
      code { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    </style>
  </head>
  <body>
    <h1>Practice for the APUSH timeline test :D</h1>

    <div class="card">
      <img src="timeline1.png" alt="first timeline" width="500"><br>
      <div id="choices"></div>
      <label for="A1">A</label>
      <input id="A1" placeholder="1, 2, 3, 4, or 5" /><br>
      <label for="B1">B</label>
      <input id="B1" placeholder="1, 2, 3, 4, or 5" /><br>
      <label for="C1">C</label>
      <input id="C1" placeholder="1, 2, 3, 4, or 5" /><br>
      <label for="D1">D</label>
      <input id="D1" placeholder="1, 2, 3, 4, or 5" /><br>
      <label for="E1">E</label>
      <input id="E1" placeholder="1, 2, 3, 4, or 5" /><br>
      <button onclick="runScript()">Check Answer</button>
      <div id="out" style="margin-top: .8rem;">Output will appear here…</div>
    </div>
  </body>
</html>
